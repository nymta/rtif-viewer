(this["webpackJsonprtif-viewer"]=this["webpackJsonprtif-viewer"]||[]).push([[429],{1487:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return p}));var n=r(35),a=r(245),i=r.n(a);var o=function(e){var t=e.get("geography"),r=Array.from(e.get("trip").values()).filter((function(e){return 1===e.get("tripType")})),a=i.a.uniqWith(r.flatMap((function(e){var t=e.get("event").map((function(e){return e.get("location")}));"S"!==e.get("direction")&&i.a.reverse(t);var r=t,a=i.a.slice(t,1);return i.a.zip(r,a).filter((function(e){var t=Object(n.a)(e,2),r=t[0],a=t[1];return!!r&&!!a&&r!==a}))})),i.a.isEqual),o=i.a.uniq(i.a.flatten(a));return i.a.concat(o.map((function(e){return{data:{id:e,label:t.get(e).get("shortName")}}})),a.map((function(e){var t=Object(n.a)(e,2);return{data:{source:t[0],target:t[1]}}})))},u=r(1479),l=r.n(u),c=r(1519),s=r.n(c);var d=function(){var e=this.nodes().map((function(e){return e.id()})),t=this.edges().map((function(e){return[e.source().id(),e.target().id()]}));return s.a.array(e,t)},f=function(e){e&&e("collection","topoSort",d)};l.a.use(f);var p=function(e){return l()({elements:o(e),headless:!0}).elements().topoSort()}},1645:function(e,t,r){"use strict";r.r(t);var n=r(35),a=(r(1),r(1465)),i=r(131),o=r(54),u=r(1520),l=r.n(u),c=r(1640),s=r.n(c),d=r(245),f=r.n(d),p=r(38),g=r(1487),m=r(3),b=l.a.d3.locale;function h(e,t){var r=f.a.trimEnd(e.get("tripLine")||t.get("timetable").get("lineIdentifier"),"X");return"#"+(p.j.get(r)||"0039A6")}l.a.d3.locale=function(e){var t=b(e),r=t.numberFormat;return t.numberFormat=function(e){switch(e){case"rtifTime":return function(e){return Object(p.e)(e)};default:return r(e)}},t};var y=function(e){var t=e.rtif,r=t.get("geography"),u=f.a.countBy(Array.from(r.values()),(function(e){return Object(p.c)(e.get("locationName"),r)}));function l(e){return Object(p.c)(e,r)+(u[Object(p.c)(e,r)]>1?" (".concat(e,")"):"")}var c=f.a.reverse(Object(g.a)(t).map((function(e){return l(e)}))),d=f.a.sortBy(Array.from(t.get("trip").values()).filter((function(e){return 1===e.get("tripType")})),(function(e){return e.get("originTime")})),b=d.map((function(e){var r=e.get("event");return{type:"scattergl",mode:"lines+markers",name:e.get("tripName"),line:{color:h(e,t)},x:r.map((function(e){return e.get("eventTime")})),y:r.map((function(e){return l(e.get("location"))})),meta:{direction:e.get("direction")}}})),y=function(e,t,r){return e.get("applicability").get("periods").filter((function(e){return f.a.includes(t,r(e.get("locationName")))})).map((function(e){var n=f.a.indexOf(t,r(e.get("locationName")));return{type:"line",layer:"below",xref:"x",yref:"y",x0:e.get("startingTime"),y0:n,x1:e.get("endingTime"),y1:n,opacity:.5,line:{color:"gray",dash:"solid",width:5},meta:{direction:e.get("direction")}}}))}(t,c,l),v=function(e,t,r){return e.filter((function(e){return null!=(t=e).get("reliefWorkProgramId")&&null!=t.get("reliefRunNumber")&&null!=t.get("reliefLocation")&&null!=t.get("reliefDepartureTime");var t})).map((function(e){var n=f.a.indexOf(t,r(e.get("reliefLocation")));return{text:e.get("reliefRunNumber"),hovertext:"".concat(e.get("tripName")," relieved by ").concat(e.get("reliefWorkProgramId")," run ").concat(e.get("reliefRunNumber")),xref:"x",yref:"y",x:e.get("reliefDepartureTime"),y:n,ax:-30,ay:-30,textangle:45,meta:{direction:e.get("direction")}}}))}(d,c,l);function x(e){var t=function(e,t){var r=[],n=[];return e.forEach((function(e,a){var i=e.meta.direction;i in t&&(r.push(t[i]),n.push(a))})),[r,n]}(b,e),r=Object(n.a)(t,2);return[{visible:r[0]},{},r[1]]}var N={autosize:!0,dragmode:"pan",hovermode:"closest",hoverlabel:{namelength:-1},title:Object(p.g)(t.get("timetable")),xaxis:{type:"linear",tickformat:"rtifTime"},yaxis:{type:"category",categoryorder:"array",categoryarray:c,automargin:!0},margin:{t:20,l:20,b:20,r:20},font:{family:'"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},shapes:[],annotations:v,updatemenus:[{type:"dropdown",direction:"down",x:.1,y:1.1,buttons:[{method:"update",label:"All Trips",args:x({N:!0,S:!0})},{method:"update",label:"Northbound Trips",args:x({N:!0,S:!1})},{method:"update",label:"Southbound Trips",args:x({N:!1,S:!0})},{method:"update",label:"No Trips",args:x({N:!1,S:!1})}]},{type:"dropdown",direction:"down",x:.25,y:1.1,active:0,buttons:[{method:"update",label:"All Relief",args:[{},{annotations:v}]},{method:"update",label:"Northbound Relief",args:[{},{annotations:v.filter((function(e){return"N"===e.meta.direction}))}]},{method:"update",label:"Southbound Relief",args:[{},{annotations:v.filter((function(e){return"S"===e.meta.direction}))}]},{method:"update",label:"No Relief",args:[{},{annotations:[]}]}]},{type:"dropdown",direction:"down",x:.43,y:1.1,active:3,buttons:[{method:"update",label:"All Applicability",args:[{},{shapes:y}]},{method:"update",label:"Northbound Applicability",args:[{},{shapes:y.filter((function(e){return"N"===e.meta.direction}))}]},{method:"update",label:"Southbound Applicability",args:[{},{shapes:y.filter((function(e){return"S"===e.meta.direction}))}]},{method:"update",label:"No Applicability",args:[{},{shapes:[]}]}]}]};return Object(m.jsx)(a.a,{grow:!0,direction:"row",paddingSize:"s",restrictWidth:!1,children:Object(m.jsx)(i.a,{direction:"column",gutterSize:"none",children:Object(m.jsx)(o.a,{children:Object(m.jsx)(s.a,{data:b,layout:N,config:{responsive:!0,scrollZoom:!0},style:{height:"100%",width:"100%"},useresizehandler:!0})})})})};t.default=y}}]);
//# sourceMappingURL=429.900cad88.chunk.js.map