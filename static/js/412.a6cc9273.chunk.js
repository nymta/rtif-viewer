(this["webpackJsonprtif-viewer"]=this["webpackJsonprtif-viewer"]||[]).push([[412],{1099:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return p}));var a=r(140),i=r.n(a);var n=function(e){const t=e.get("geography"),r=Array.from(e.get("trip").values()).filter((e=>1===e.get("tripType"))),a=i.a.uniqWith(r.flatMap((e=>{const t=e.get("event").map((e=>e.get("location")));"S"!==e.get("direction")&&i.a.reverse(t);const r=t,a=i.a.slice(t,1);return i.a.zip(r,a).filter((([e,t])=>!!e&&!!t&&e!==t))})),i.a.isEqual),n=i.a.uniq(i.a.flatten(a));return i.a.concat(n.map((e=>({data:{id:e,label:t.get(e).get("shortName")}}))),a.map((([e,t])=>({data:{source:e,target:t}}))))},o=r(1091),l=r.n(o),c=r(1131),s=r.n(c);var u=function(){const e=this.nodes().map((e=>e.id())),t=this.edges().map((e=>[e.source().id(),e.target().id()]));return s.a.array(e,t)};var d=function(e){e&&e("collection","topoSort",u)};l.a.use(d);var p=function(e){return l()({elements:n(e),headless:!0}).elements().topoSort()}},1256:function(e,t,r){"use strict";r.r(t);var a=r(23),i=(r(1),r(1077)),n=r(67),o=r(29),l=r(1132),c=r.n(l),s=r(1251),u=r.n(s),d=r(140),p=r.n(d),g=r(21),m=r(1099),f=r(3);const b=c.a.d3.locale;function h(e,t){const r=p.a.trimEnd(e.get("tripLine")||t.get("timetable").get("lineIdentifier"),"X");return"#"+(g.j.get(r)||"0039A6")}c.a.d3.locale=e=>{const t=b(e),r=t.numberFormat;return t.numberFormat=e=>{switch(e){case"rtifTime":return e=>Object(g.e)(e);default:return r(e)}},t};var y=function({rtif:e}){const t=e.get("geography"),r=p.a.countBy(Array.from(t.values()),(e=>Object(g.c)(e.get("locationName"),t)));function l(e){return Object(g.c)(e,t)+(r[Object(g.c)(e,t)]>1?" (".concat(e,")"):"")}const c=p.a.reverse(Object(m.a)(e).map((e=>l(e)))),s=p.a.sortBy(Array.from(e.get("trip").values()).filter((e=>1===e.get("tripType"))),(e=>e.get("originTime"))),d=s.map((t=>{const r=t.get("event");return{type:"scattergl",mode:"lines+markers",name:t.get("tripName"),line:{color:h(t,e)},x:r.map((e=>e.get("eventTime"))),y:r.map((e=>l(e.get("location")))),meta:{direction:t.get("direction")}}})),b=function(e,t,r){return e.get("applicability").get("periods").filter((e=>p.a.includes(t,r(e.get("locationName"))))).map((e=>{const a=p.a.indexOf(t,r(e.get("locationName")));return{type:"line",layer:"below",xref:"x",yref:"y",x0:e.get("startingTime"),y0:a,x1:e.get("endingTime"),y1:a,opacity:.5,line:{color:"gray",dash:"solid",width:5},meta:{direction:e.get("direction")}}}))}(e,c,l),y=function(e,t,r){return e.filter((e=>{return null!=(t=e).get("reliefWorkProgramId")&&null!=t.get("reliefRunNumber")&&null!=t.get("reliefLocation")&&null!=t.get("reliefDepartureTime");var t})).map((e=>{const a=p.a.indexOf(t,r(e.get("reliefLocation")));return{text:e.get("reliefRunNumber"),hovertext:"".concat(e.get("tripName")," relieved by ").concat(e.get("reliefWorkProgramId")," run ").concat(e.get("reliefRunNumber")),xref:"x",yref:"y",x:e.get("reliefDepartureTime"),y:a,ax:-30,ay:-30,textangle:45,meta:{direction:e.get("direction")}}}))}(s,c,l);function v(e){const t=function(e,t){const r=[],a=[];return e.forEach(((e,i)=>{const n=e.meta.direction;n in t&&(r.push(t[n]),a.push(i))})),[r,a]}(d,e),r=Object(a.a)(t,2);return[{visible:r[0]},{},r[1]]}const x={autosize:!0,dragmode:"pan",hovermode:"closest",hoverlabel:{namelength:-1},title:Object(g.g)(e.get("timetable")),xaxis:{type:"linear",tickformat:"rtifTime"},yaxis:{type:"category",categoryorder:"array",categoryarray:c,automargin:!0},margin:{t:20,l:20,b:20,r:20},font:{family:'"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'},shapes:[],annotations:y,updatemenus:[{type:"dropdown",direction:"down",x:.1,y:1.1,buttons:[{method:"update",label:"All Trips",args:v({N:!0,S:!0})},{method:"update",label:"Northbound Trips",args:v({N:!0,S:!1})},{method:"update",label:"Southbound Trips",args:v({N:!1,S:!0})},{method:"update",label:"No Trips",args:v({N:!1,S:!1})}]},{type:"dropdown",direction:"down",x:.25,y:1.1,active:0,buttons:[{method:"update",label:"All Relief",args:[{},{annotations:y}]},{method:"update",label:"Northbound Relief",args:[{},{annotations:y.filter((e=>"N"===e.meta.direction))}]},{method:"update",label:"Southbound Relief",args:[{},{annotations:y.filter((e=>"S"===e.meta.direction))}]},{method:"update",label:"No Relief",args:[{},{annotations:[]}]}]},{type:"dropdown",direction:"down",x:.43,y:1.1,active:3,buttons:[{method:"update",label:"All Applicability",args:[{},{shapes:b}]},{method:"update",label:"Northbound Applicability",args:[{},{shapes:b.filter((e=>"N"===e.meta.direction))}]},{method:"update",label:"Southbound Applicability",args:[{},{shapes:b.filter((e=>"S"===e.meta.direction))}]},{method:"update",label:"No Applicability",args:[{},{shapes:[]}]}]}]};return Object(f.jsx)(i.a,{grow:!0,direction:"row",paddingSize:"s",restrictWidth:!1,children:Object(f.jsx)(n.a,{direction:"column",gutterSize:"none",children:Object(f.jsx)(o.a,{children:Object(f.jsx)(u.a,{data:d,layout:x,config:{responsive:!0,scrollZoom:!0},style:{height:"100%",width:"100%"},useresizehandler:!0})})})})};t.default=y}}]);
//# sourceMappingURL=412.a6cc9273.chunk.js.map